(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     15555,        418]
NotebookOptionsPosition[     14657,        381]
NotebookOutlinePosition[     15027,        397]
CellTagsIndexPosition[     14984,        394]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Export/Import", "Section",
 CellChangeTimes->{{3.629196256859927*^9, 3.6291962647532744`*^9}}],

Cell[BoxData[
 RowBox[{"ParametricPlot3D", "[", 
  RowBox[{
   RowBox[{"Evaluate", "[", 
    RowBox[{
     RowBox[{"RotationTransform", "[", 
      RowBox[{"v", ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], "]"}], "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"u", " ", 
        RowBox[{"Rescale", "[", 
         RowBox[{"v", ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", 
            RowBox[{"6", " ", "\[Pi]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"1", ",", "1"}], "}"}]}], "]"}]}], ",", "0", ",", 
       RowBox[{
        RowBox[{"v", "/", "10"}], "+", 
        RowBox[{"(", 
         RowBox[{"u", "^", ".5"}], ")"}]}]}], "}"}], "]"}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"u", ",", "0", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"v", ",", "0", ",", 
     RowBox[{"6", " ", "\[Pi]"}]}], "}"}], ",", 
   RowBox[{"Boxed", "\[Rule]", "False"}], ",", 
   RowBox[{"Axes", "\[Rule]", "None"}], ",", 
   RowBox[{"Mesh", "\[Rule]", "None"}], ",", 
   RowBox[{"PerformanceGoal", "\[Rule]", "\"\<Quality\>\""}], ",", 
   RowBox[{"PlotPoints", "\[Rule]", 
    RowBox[{"Round", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"1", "/", ".1"}], ",", 
       RowBox[{"6", 
        RowBox[{"\[Pi]", "/", ".1"}]}]}], "}"}], "]"}]}]}], "]"}]], "Input",
 CellChangeTimes->{{3.6291962825874434`*^9, 3.6291962846621895`*^9}, {
  3.629196487465826*^9, 3.629196519543413*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Export", "[", 
  RowBox[{
  "\"\<C:\\\\Users\\\\carlson\\\\Desktop\\\\Surface.stl\>\"", ",", "%"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.629196291905404*^9, 3.6291962943233423`*^9}, {
  3.629196346996028*^9, 3.62919638032156*^9}, {3.6291964132103057`*^9, 
  3.629196415363037*^9}}],

Cell[BoxData["\<\"C:\\\\Users\\\\carlson\\\\Desktop\\\\Surface.stl\"\>"], \
"Output",
 CellChangeTimes->{3.6291963837534494`*^9, 3.629196527629006*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["NETLink", "Section",
 CellChangeTimes->{{3.629196621594513*^9, 3.629196622717677*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"LoadNETType", "[", "\"\<Rhino.Geometry.NurbsSurface\>\"", "]"}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
  "LoadNETType", "[", "\"\<Wolfram.Rhino.WolframScriptingPlugIn\>\"", "]"}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"LoadNETType", "[", "\"\<Rhino.RhinoDoc\>\"", "]"}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.6257681661991916`*^9, 3.6257681686073294`*^9}, {
  3.6258712933118954`*^9, 3.6258713007689342`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"obj", "=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"uMin", "=", "0"}], ",", 
       RowBox[{"uMax", "=", "1"}], ",", 
       RowBox[{"vMin", "=", "0"}], ",", 
       RowBox[{"vMax", "=", 
        RowBox[{"6", "\[Pi]"}]}], ",", 
       RowBox[{"du", "=", ".1"}], ",", 
       RowBox[{"dv", "=", ".1"}]}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"NurbsSurface`CreateThroughPoints", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"ToRhino", "[", 
        RowBox[{"Flatten", "[", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"Evaluate", "[", 
             RowBox[{
              RowBox[{"RotationTransform", "[", 
               RowBox[{"v", ",", 
                RowBox[{"{", 
                 RowBox[{"0", ",", "0", ",", "1"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], "]"}], "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"u", " ", 
                 RowBox[{"Rescale", "[", 
                  RowBox[{"v", ",", 
                   RowBox[{"{", 
                    RowBox[{"0", ",", 
                    RowBox[{"6", " ", "\[Pi]"}]}], "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"1", ",", "1"}], "}"}]}], "]"}]}], ",", "0", ",", 
                RowBox[{
                 RowBox[{"v", "/", "10"}], "+", 
                 RowBox[{"(", 
                  RowBox[{"u", "^", ".5"}], ")"}]}]}], "}"}], "]"}], "]"}], 
            ",", 
            RowBox[{"{", 
             RowBox[{"u", ",", "uMin", ",", "uMax", ",", "du"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"v", ",", "vMin", ",", "vMax", ",", "dv"}], "}"}]}], 
           "]"}], ",", "1"}], "]"}], "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"Floor", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"uMax", "-", "uMin"}], ")"}], "/", "du"}], "+", "1"}], 
        "]"}], ",", 
       RowBox[{"Floor", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"vMax", "-", "vMin"}], ")"}], "/", "dv"}], "+", "1"}], 
        "]"}], ",", " ", "3", ",", " ", "3", ",", " ", "False", ",", 
       "False"}], "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}], "\n", 
 RowBox[{"RhinoShow", "[", "obj", "]"}]}], "Input",
 CellChangeTimes->{{3.6257681788149133`*^9, 3.6257682023522596`*^9}, {
   3.6257682976967125`*^9, 3.625768340920185*^9}, {3.625768384328668*^9, 
   3.6257684456801767`*^9}, {3.6257685008243313`*^9, 3.625768518443339*^9}, {
   3.6257686046272683`*^9, 3.625768607432429*^9}, {3.6258707556023755`*^9, 
   3.6258707595958986`*^9}, 3.6258707909980946`*^9, {3.6258709388984656`*^9, 
   3.625870972609277*^9}, {3.625871315776583*^9, 3.6258713530303383`*^9}, {
   3.625871622696224*^9, 3.625871717476334*^9}, {3.6258718697840805`*^9, 
   3.6258718876143093`*^9}, {3.629158187865441*^9, 3.629158192997742*^9}, {
   3.6291585494754953`*^9, 3.6291585922113953`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  InterpretationBox[
   RowBox[{"\[LeftGuillemet]", 
    RowBox[{"NETObject", "[", 
     RowBox[{"System", ".", "Guid"}], "]"}], "\[RightGuillemet]"}],
   NETLink`Objects`NETObject$35558132927168513], "}"}]], "Output",
 CellChangeTimes->{3.6291581944953136`*^9, 3.6291582901353493`*^9, 
  3.6291585928665953`*^9, 3.6291946201293592`*^9, 3.6291966284763923`*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Interactive Surface", "Section",
 CellChangeTimes->{{3.6291965676413803`*^9, 3.629196571213689*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"LoadNETType", "[", "\"\<Rhino.Geometry.NurbsSurface\>\"", "]"}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
  "LoadNETType", "[", "\"\<Wolfram.Rhino.WolframScriptingPlugIn\>\"", "]"}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"LoadNETType", "[", "\"\<Rhino.RhinoDoc\>\"", "]"}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.6257681661991916`*^9, 3.6257681686073294`*^9}, {
  3.6258712933118954`*^9, 3.6258713007689342`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Manipulate", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Dynamic", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"guids", "=", 
      RowBox[{"RhinoReshow", "[", 
       RowBox[{"guids", ",", " ", 
        RowBox[{"With", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"uMin", "=", "0"}], ",", 
            RowBox[{"uMax", "=", "1"}], ",", 
            RowBox[{"vMin", "=", "0"}], ",", 
            RowBox[{"vMax", "=", 
             RowBox[{"6", "\[Pi]"}]}], ",", 
            RowBox[{"du", "=", ".1"}], ",", 
            RowBox[{"dv", "=", ".1"}]}], "}"}], ",", "\[IndentingNewLine]", 
          RowBox[{
          "NurbsSurface`CreateThroughPoints", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"ToRhino", "[", 
             RowBox[{"Flatten", "[", 
              RowBox[{
               RowBox[{"Table", "[", 
                RowBox[{
                 RowBox[{"Evaluate", "[", 
                  RowBox[{
                   RowBox[{"RotationTransform", "[", 
                    RowBox[{"v", ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0", ",", "1"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], "]"}], "[", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"u", " ", 
                    RowBox[{"Rescale", "[", 
                    RowBox[{"v", ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", 
                    RowBox[{"6", " ", "\[Pi]"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", "tap"}], "}"}]}], "]"}]}], ",", "0", 
                    ",", 
                    RowBox[{
                    RowBox[{"v", "/", "str"}], "+", 
                    RowBox[{"(", 
                    RowBox[{"u", "^", ".5"}], ")"}]}]}], "}"}], "]"}], "]"}], 
                 ",", 
                 RowBox[{"{", 
                  RowBox[{"u", ",", "uMin", ",", "uMax", ",", "du"}], "}"}], 
                 ",", 
                 RowBox[{"{", 
                  RowBox[{"v", ",", "vMin", ",", "vMax", ",", "dv"}], "}"}]}],
                 "]"}], ",", "1"}], "]"}], "]"}], ",", "\[IndentingNewLine]", 
            RowBox[{"Floor", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{"uMax", "-", "uMin"}], ")"}], "/", "du"}], "+", "1"}],
              "]"}], ",", 
            RowBox[{"Floor", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{"vMax", "-", "vMin"}], ")"}], "/", "dv"}], "+", "1"}],
              "]"}], ",", " ", "3", ",", " ", "3", ",", " ", "False", ",", 
            "False"}], "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
         "]"}]}], "]"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"TrackedSymbols", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"tap", ",", "str"}], "}"}]}]}], "\[IndentingNewLine]", "]"}], 
   ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"tap", ",", "1", ",", "\"\<taper\>\""}], "}"}], ",", "0", ",", 
     "2"}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"str", ",", "5", ",", "\"\<stretch\>\""}], "}"}], ",", "1", ",",
      "20"}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{"guids", ",", 
     RowBox[{"{", "}"}], ",", 
     RowBox[{"ControlType", "\[Rule]", "None"}]}], "}"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"ControlPlacement", "\[Rule]", "Top"}]}], "\[IndentingNewLine]", 
  "]"}]], "Input",
 CellChangeTimes->{{3.629196740267269*^9, 3.629196740485664*^9}, 
   3.62920092174085*^9}],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`guids$$ = {
    NETLink`Objects`NETObject$68004408251645953}, $CellContext`str$$ = 
    13.26, $CellContext`tap$$ = 0., Typeset`show$$ = True, 
    Typeset`bookmarkList$$ = {}, Typeset`bookmarkMode$$ = "Menu", 
    Typeset`animator$$, Typeset`animvar$$ = 1, Typeset`name$$ = 
    "\"untitled\"", Typeset`specs$$ = {{{
       Hold[$CellContext`tap$$], 1, "taper"}, 0, 2}, {{
       Hold[$CellContext`str$$], 5, "stretch"}, 1, 20}, {
      Hold[$CellContext`guids$$], {}}}, Typeset`size$$ = {217., {2., 8.}}, 
    Typeset`update$$ = 0, Typeset`initDone$$, Typeset`skipInitDone$$ = 
    True, $CellContext`tap$50911$$ = 0, $CellContext`str$50912$$ = 0}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     1, StandardForm, 
      "Variables" :> {$CellContext`guids$$ = {}, $CellContext`str$$ = 
        5, $CellContext`tap$$ = 1}, "ControllerVariables" :> {
        Hold[$CellContext`tap$$, $CellContext`tap$50911$$, 0], 
        Hold[$CellContext`str$$, $CellContext`str$50912$$, 0]}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, "Body" :> 
      Dynamic[$CellContext`guids$$ = 
        RhinoUtilities`RhinoReshow[$CellContext`guids$$, 
          
          With[{$CellContext`uMin$ = 0, $CellContext`uMax$ = 
            1, $CellContext`vMin$ = 0, $CellContext`vMax$ = 
            6 Pi, $CellContext`du$ = 0.1, $CellContext`dv$ = 0.1}, 
           NurbsSurface`CreateThroughPoints[
            RhinoUtilities`ToRhino[
             Flatten[
              Table[
               Evaluate[
                
                RotationTransform[$CellContext`v, {0, 0, 1}, {0, 0, 
                 0}][{$CellContext`u 
                  Rescale[$CellContext`v, {0, 6 Pi}, {1, $CellContext`tap$$}],
                   0, $CellContext`v/$CellContext`str$$ + \
$CellContext`u^0.5}]], {$CellContext`u, $CellContext`uMin$, \
$CellContext`uMax$, $CellContext`du$}, {$CellContext`v, $CellContext`vMin$, \
$CellContext`vMax$, $CellContext`dv$}], 1]], 
            
            Floor[($CellContext`uMax$ - $CellContext`uMin$)/$CellContext`du$ + 
             1], 
            
            Floor[($CellContext`vMax$ - $CellContext`vMin$)/$CellContext`dv$ + 
             1], 3, 3, False, False]]], 
        TrackedSymbols -> {$CellContext`tap$$, $CellContext`str$$}], 
      "Specifications" :> {{{$CellContext`tap$$, 1, "taper"}, 0, 
         2}, {{$CellContext`str$$, 5, "stretch"}, 1, 
         20}, {$CellContext`guids$$, {}, ControlType -> None}}, 
      "Options" :> {ControlPlacement -> Top}, "DefaultOptions" :> {}],
     ImageSizeCache->{286., {65., 72.}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    SynchronousInitialization->True,
    UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellChangeTimes->{
  3.6291966796087255`*^9, {3.6291967414216394`*^9, 3.629196747570382*^9}, 
   3.629200926795185*^9}]
}, Open  ]]
}, Open  ]]
},
Evaluator->"RhinoAttach",
WindowSize->{767, 618},
WindowMargins->{{Automatic, 2}, {Automatic, 8}},
FrontEndVersion->"10.0 for Microsoft Windows (64-bit) (September 9, 2014)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 100, 1, 63, "Section"],
Cell[683, 25, 1535, 42, 112, "Input"],
Cell[CellGroupData[{
Cell[2243, 71, 310, 7, 31, "Input"],
Cell[2556, 80, 151, 2, 31, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[2756, 88, 92, 1, 63, "Section"],
Cell[2851, 91, 449, 12, 72, "Input"],
Cell[CellGroupData[{
Cell[3325, 107, 3114, 72, 232, "Input"],
Cell[6442, 181, 390, 8, 31, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[6881, 195, 106, 1, 63, "Section"],
Cell[6990, 198, 449, 12, 72, "Input"],
Cell[CellGroupData[{
Cell[7464, 214, 3810, 93, 392, "Input"],
Cell[11277, 309, 3352, 68, 154, "Output"]
}, Open  ]]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
