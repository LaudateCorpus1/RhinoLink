(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     14590,        353]
NotebookOptionsPosition[     13754,        318]
NotebookOutlinePosition[     14156,        335]
CellTagsIndexPosition[     14113,        332]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Simple Box Design Widget", "Title",
 CellChangeTimes->{{3.6207604105424023`*^9, 3.6207604167107553`*^9}, {
  3.6208609267970285`*^9, 3.6208609271714287`*^9}, {3.620861273866438*^9, 
  3.620861275473241*^9}, {3.620883421956933*^9, 3.6208834243281374`*^9}, {
  3.6220706110283947`*^9, 3.6220706167483945`*^9}}],

Cell[CellGroupData[{

Cell["Agenda", "Section",
 CellChangeTimes->{{3.6220705492173944`*^9, 3.622070549864394*^9}}],

Cell["- add a picker to connect the manipulate to a selected box", "Text",
 CellChangeTimes->{{3.6209010110481687`*^9, 3.6209010291130004`*^9}, 
   3.6209225521863475`*^9, {3.6220705600083942`*^9, 3.6220705638633947`*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["Setup", "Section",
 CellChangeTimes->{{3.6220705088503942`*^9, 3.622070516482394*^9}}],

Cell["In Rhino, execute WolframStartScripting.", "Text",
 CellChangeTimes->{{3.6220705912773943`*^9, 3.6220706257713947`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Initialization", "Section",
 InitializationGroup->True,
 CellChangeTimes->{{3.6220705355133944`*^9, 3.6220705394013944`*^9}, {
  3.622635662232705*^9, 3.6226356640267625`*^9}}],

Cell["A simple box design widget.", "Text",
 CellChangeTimes->{{3.6208834294137464`*^9, 3.620883456403396*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"BoxDesignWidget", "[", "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"DynamicModule", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"doc", ",", " ", "guid", ",", " ", "displayModes"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
     "LoadNETType", "[", "\"\<Rhino.Display.DisplayModeDescription\>\"", 
      "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"LoadNETType", "[", "\"\<Rhino.RhinoApp\>\"", "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"displayModes", " ", "=", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"#", "@", "EnglishName"}], ")"}], "&"}], " ", "/@", " ", 
       RowBox[{
       "Rhino`Display`DisplayModeDescription`GetDisplayModes", "[", "]"}]}]}],
      ";", "\[IndentingNewLine]", 
     RowBox[{"Manipulate", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"NETBlock", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"doc", "@", 
          RowBox[{"Objects", "@", 
           RowBox[{"Replace", "[", 
            RowBox[{"guid", ",", "\[IndentingNewLine]", 
             RowBox[{"Brep`CreateFromBox", "[", 
              RowBox[{"NETNew", "[", 
               RowBox[{
               "\"\<Rhino.Geometry.BoundingBox\>\"", ",", 
                "\[IndentingNewLine]", 
                RowBox[{"NETNew", "[", 
                 RowBox[{
                 "\"\<Rhino.Geometry.Point3d\>\"", ",", " ", "x", ",", "y", 
                  ",", "z"}], "]"}], ",", "\[IndentingNewLine]", 
                RowBox[{"NETNew", "[", 
                 RowBox[{"\"\<Rhino.Geometry.Point3d\>\"", ",", " ", 
                  RowBox[{"x", "+", "l"}], ",", 
                  RowBox[{"y", "+", "w"}], ",", 
                  RowBox[{"z", "+", "h"}]}], "]"}]}], "]"}], "]"}]}], 
            "]"}]}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"doc", "@", 
          RowBox[{"Views", "@", 
           RowBox[{"Redraw", "[", "]"}]}]}], ";", "\[IndentingNewLine]", 
         "\"\<\>\""}], "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"Row", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"\"\<pos:\>\"", ",", 
             RowBox[{"{", 
              RowBox[{"x", ",", "y", ",", "z"}], "}"}], ",", " ", 
             "\"\< dim:\>\"", ",", 
             RowBox[{"{", 
              RowBox[{"l", ",", "w", ",", "h"}], "}"}]}], "}"}], ",", 
           "\"\< \>\""}], "]"}], " ", "*)"}], "\[IndentingNewLine]", "]"}], 
       ",", "\[IndentingNewLine]", 
       RowBox[{"ActionMenu", "[", 
        RowBox[{"\"\<display mode\>\"", ",", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"#", "\[RuleDelayed]", "\[IndentingNewLine]", 
             RowBox[{"(*", " ", 
              RowBox[{
              "for", " ", "some", " ", "reason", " ", "it", " ", "takes", " ",
                "two", " ", "invocations", " ", "to", " ", "set", " ", "all", 
               " ", 
               RowBox[{"viewports", "'"}], " ", "display", " ", "modes"}], 
              " ", "*)"}], "\[IndentingNewLine]", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"RhinoApp`RunScript", "[", 
                RowBox[{
                 RowBox[{
                 "\"\<_SetDisplayMode Viewport=All \\\"\>\"", "<>", "#", 
                  "<>", "\"\<\\\" _Enter\>\""}], ",", "False"}], "]"}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"RhinoApp`RunScript", "[", 
                RowBox[{
                 RowBox[{
                 "\"\<_SetDisplayMode Viewport=All \\\"\>\"", "<>", "#", 
                  "<>", "\"\<\\\" _Enter\>\""}], ",", "False"}], "]"}]}], 
              ")"}]}], "\[IndentingNewLine]", ")"}], "&"}], " ", "/@", " ", 
          "displayModes"}], ",", 
         RowBox[{"ImageSize", "\[Rule]", "Medium"}]}], "]"}], ",", 
       "\[IndentingNewLine]", "Delimiter", ",", "\[IndentingNewLine]", 
       RowBox[{"Grid", "[", 
        RowBox[{
         RowBox[{"Transpose", "@", 
          RowBox[{"{", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
             "\"\<length\>\"", ",", "\"\<width\>\"", ",", "\"\<height\>\""}], 
             "}"}], ",", "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Control", "[", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"l", ",", "1", ",", "\"\<\>\""}], "}"}], ",", "1", 
                 ",", "10", ",", "1", ",", 
                 RowBox[{"ImageSize", "\[Rule]", "Small"}]}], "}"}], "]"}], 
              ",", "\[IndentingNewLine]", 
              RowBox[{"Control", "[", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"w", ",", "1", ",", "\"\<\>\""}], "}"}], ",", "1", 
                 ",", "10", ",", "1", ",", 
                 RowBox[{"ImageSize", "\[Rule]", "Small"}]}], "}"}], "]"}], 
              ",", "\[IndentingNewLine]", 
              RowBox[{"Control", "[", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"h", ",", "1", ",", "\"\<\>\""}], "}"}], ",", "1", 
                 ",", "10", ",", "1", ",", 
                 RowBox[{"ImageSize", "\[Rule]", "Small"}]}], "}"}], "]"}]}], 
             "}"}], ",", "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{"\"\<\>\"", ",", "\"\<\>\"", ",", "\"\<\>\""}], "}"}], 
            ",", "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{"\"\<x\>\"", ",", "\"\<y\>\"", ",", "\"\<z\>\""}], "}"}],
             ",", "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Control", "[", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"x", ",", "0", ",", "\"\<\>\""}], "}"}], ",", "0", 
                 ",", "10", ",", "1", ",", 
                 RowBox[{"ImageSize", "\[Rule]", "Small"}]}], "}"}], "]"}], 
              ",", "\[IndentingNewLine]", 
              RowBox[{"Control", "[", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"y", ",", "0", ",", "\"\<\>\""}], "}"}], ",", "0", 
                 ",", "10", ",", "1", ",", 
                 RowBox[{"ImageSize", "\[Rule]", "Small"}]}], "}"}], "]"}], 
              ",", "\[IndentingNewLine]", 
              RowBox[{"Control", "[", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"z", ",", "0", ",", "\"\<\>\""}], "}"}], ",", "0", 
                 ",", "10", ",", "1", ",", 
                 RowBox[{"ImageSize", "\[Rule]", "Small"}]}], "}"}], "]"}]}], 
             "}"}]}], "\[IndentingNewLine]", "}"}]}], ",", 
         RowBox[{"Alignment", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"Right", ",", "Left", ",", "Right", ",", "Left"}], 
           "}"}]}]}], "]"}], ",", "\[IndentingNewLine]", "\"\<\>\"", ",", 
       "\[IndentingNewLine]", 
       RowBox[{"Button", "[", 
        RowBox[{"\"\<new box\>\"", ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"guid", "=", 
           RowBox[{"doc", "@", 
            RowBox[{"Objects", "@", 
             RowBox[{"Add", "[", 
              RowBox[{"Brep`CreateFromBox", "[", 
               RowBox[{"NETNew", "[", 
                RowBox[{
                "\"\<Rhino.Geometry.BoundingBox\>\"", ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"NETNew", "[", 
                  RowBox[{
                  "\"\<Rhino.Geometry.Point3d\>\"", ",", " ", "x", ",", "y", 
                   ",", "z"}], "]"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"NETNew", "[", 
                  RowBox[{"\"\<Rhino.Geometry.Point3d\>\"", ",", "  ", 
                   RowBox[{"x", "+", "l"}], ",", 
                   RowBox[{"y", "+", "w"}], ",", 
                   RowBox[{"z", "+", "h"}]}], "]"}]}], "]"}], "]"}], 
              "]"}]}]}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"doc", "@", 
           RowBox[{"Views", "@", 
            RowBox[{"Redraw", "[", "]"}]}]}]}]}], "\[IndentingNewLine]", 
        "]"}], ",", "\[IndentingNewLine]", "\"\<\>\"", ",", 
       "\[IndentingNewLine]", 
       RowBox[{"Initialization", "\[RuleDelayed]", 
        RowBox[{"Block", "[", 
         RowBox[{
          RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"LoadNETType", "[", "\"\<Rhino.RhinoDoc\>\"", "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"LoadNETType", "[", "\"\<Rhino.Geometry.Brep\>\"", "]"}], 
           ";", "\[IndentingNewLine]", 
           RowBox[{
           "LoadNETType", "[", "\"\<Rhino.Display.DisplayModeDescription\>\"",
             "]"}], ";", "\[IndentingNewLine]", 
           RowBox[{"LoadNETType", "[", "\"\<Rhino.RhinoApp\>\"", "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"doc", "=", "RhinoDoc`ActiveDoc"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"guid", "=", 
            RowBox[{"doc", "@", 
             RowBox[{"Objects", "@", 
              RowBox[{"Add", "[", 
               RowBox[{"Brep`CreateFromBox", "[", 
                RowBox[{"NETNew", "[", 
                 RowBox[{
                 "\"\<Rhino.Geometry.BoundingBox\>\"", ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{"NETNew", "[", 
                   RowBox[{
                   "\"\<Rhino.Geometry.Point3d\>\"", ",", " ", "0", ",", "0", 
                    ",", "0"}], "]"}], ",", "\[IndentingNewLine]", 
                  RowBox[{"NETNew", "[", 
                   RowBox[{
                   "\"\<Rhino.Geometry.Point3d\>\"", ",", " ", "1", ",", "1", 
                    ",", "1"}], "]"}]}], "]"}], "]"}], "]"}]}]}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"doc", "@", 
            RowBox[{"Views", "@", 
             RowBox[{"Redraw", "[", "]"}]}]}]}]}], "\[IndentingNewLine]", 
         "]"}]}]}], "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.620861236005172*^9, 3.620861265894824*^9}, {
   3.620862175112627*^9, 3.6208623442637243`*^9}, {3.620862376602581*^9, 
   3.620862426600669*^9}, {3.6208625274704456`*^9, 3.620862540730469*^9}, {
   3.6208627629840593`*^9, 3.6208627845900974`*^9}, {3.620882392183524*^9, 
   3.6208823967387323`*^9}, {3.6208825294949656`*^9, 
   3.6208825433165903`*^9}, {3.6208826059663*^9, 3.6208826113951097`*^9}, {
   3.6208828681715603`*^9, 3.6208828989504147`*^9}, {3.6208829517565074`*^9, 
   3.6208829882761717`*^9}, {3.620883019195426*^9, 3.6208830361526556`*^9}, {
   3.6208831199872026`*^9, 3.620883140236038*^9}, {3.6208831937285323`*^9, 
   3.6208831958189363`*^9}, {3.6208832399514136`*^9, 3.620883302257923*^9}, {
   3.6208834816754403`*^9, 3.6208836564269476`*^9}, {3.620884767989106*^9, 
   3.6208847830275326`*^9}, 3.6209002366337276`*^9, {3.620900310874258*^9, 
   3.6209003443675165`*^9}, {3.62090042962354*^9, 3.6209006414211197`*^9}, {
   3.620900704055229*^9, 3.6209007103108406`*^9}, {3.6209008012122*^9, 
   3.6209008192458315`*^9}, {3.6209008628323083`*^9, 3.620900890397557*^9}, {
   3.6209009471660566`*^9, 3.620900947556057*^9}, {3.6226356496279435`*^9, 
   3.6226356558677006`*^9}, {3.62263601581553*^9, 3.622636291754629*^9}, {
   3.622636360114093*^9, 3.6226363675397882`*^9}, {3.62263639923607*^9, 
   3.6226365275403776`*^9}, {3.622636607035101*^9, 3.622636627158327*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["Box Design Widget", "Section",
 CellChangeTimes->{{3.622635690532012*^9, 3.62263569422933*^9}}],

Cell[BoxData[
 RowBox[{"BoxDesignWidget", "[", "]"}]], "Input",
 CellChangeTimes->{{3.622635696148192*^9, 3.6226356995179*^9}}]
}, Open  ]]
}, Open  ]]
},
Evaluator->"RhinoAttach",
WindowSize->{868, 1009},
WindowMargins->{{Automatic, -3}, {Automatic, 4}},
Magnification:>1.4 Inherited,
FrontEndVersion->"10.0 for Microsoft Windows (64-bit) (September 9, 2014)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 314, 4, 125, "Title"],
Cell[CellGroupData[{
Cell[919, 30, 93, 1, 87, "Section"],
Cell[1015, 33, 222, 2, 58, "Text"]
}, Closed]],
Cell[CellGroupData[{
Cell[1274, 40, 92, 1, 66, "Section"],
Cell[1369, 43, 126, 1, 42, "Text"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1532, 49, 182, 3, 87, "Section",
 InitializationGroup->True],
Cell[1717, 54, 111, 1, 42, "Text"],
Cell[1831, 57, 11627, 247, 1744, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[13495, 309, 101, 1, 66, "Section"],
Cell[13599, 312, 127, 2, 42, "Input"]
}, Open  ]]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
