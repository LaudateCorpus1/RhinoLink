(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     17448,        403]
NotebookOptionsPosition[     16080,        372]
NotebookOutlinePosition[     16446,        388]
CellTagsIndexPosition[     16403,        385]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Simple Box Design Widget", "Title",
 CellChangeTimes->{{3.6207604105424023`*^9, 3.6207604167107553`*^9}, {
  3.6208609267970285`*^9, 3.6208609271714287`*^9}, {3.620861273866438*^9, 
  3.620861275473241*^9}, {3.620883421956933*^9, 3.6208834243281374`*^9}, {
  3.6220706110283947`*^9, 
  3.6220706167483945`*^9}},ExpressionUUID->"f934e75a-8f02-49ca-83d8-\
c79ba5b801fd"],

Cell[TextData[{
 "Example of controlling objects in Rhino from an interface in ",
 StyleBox["Mathematica",
  FontSlant->"Italic"],
 "."
}], "Text",
 CellChangeTimes->{{3.668171147134261*^9, 3.6681711566658*^9}, {
  3.731777867939141*^9, 
  3.731777893501794*^9}},ExpressionUUID->"09d236c1-1394-4427-a88e-\
743caae89d70"],

Cell[CellGroupData[{

Cell["Example", "Section",
 CellChangeTimes->{{3.622635690532012*^9, 3.62263569422933*^9}, {
  3.7317777864129233`*^9, 
  3.731777787099834*^9}},ExpressionUUID->"b0ccd80e-5534-4d72-9a41-\
1412106bc697"],

Cell["\<\
If you haven\[CloseCurlyQuote]t already done so, execute WolframConnect in \
Rhino.\
\>", "Text",
 CellChangeTimes->{{3.731777804036372*^9, 3.7317778320842924`*^9}, 
   3.7318034190325947`*^9},ExpressionUUID->"82e64266-4686-42cf-ad3b-\
7ad0d63d1cb6"],

Cell["\<\
Then evaluate this expression (and answer \[OpenCurlyDoubleQuote]yes\
\[CloseCurlyDoubleQuote] to the initialization pop-up):\
\>", "Text",
 CellChangeTimes->{{3.7317778391474094`*^9, 3.731777845507572*^9}, {
  3.7317781846836367`*^9, 
  3.7317782093385143`*^9}},ExpressionUUID->"0f862c8e-d41b-4300-a88e-\
3b25b2e2d57f"],

Cell[BoxData[
 RowBox[{"BoxDesignWidget", "[", "]"}]], "Input",
 CellChangeTimes->{{3.622635696148192*^9, 3.6226356995179*^9}},
 CellLabel->"In[2]:=",ExpressionUUID->"02b37985-8aff-4e0b-aa38-4919feb0b032"],

Cell["\<\
A unit box should appear in Rhino. Drag sliders to control the size and \
position of the box.\
\>", "Text",
 CellChangeTimes->{{3.7317779219855213`*^9, 
  3.731777946618165*^9}},ExpressionUUID->"86837ee1-19d4-417e-b473-\
cf198c7ef40a"],

Cell["\<\
To create a new box, click the \[OpenCurlyDoubleQuote]new box\
\[CloseCurlyDoubleQuote] button. The new box is coincident with the old box, \
so you won\[CloseCurlyQuote]t see it until you use the sliders to reposition \
or resize it.\
\>", "Text",
 CellChangeTimes->{{3.668171196740636*^9, 3.6681712480935316`*^9}, {
  3.668341919524973*^9, 3.668341979280487*^9}, {3.731777955842379*^9, 
  3.7317780240011244`*^9}},ExpressionUUID->"c3da9f8b-ac13-45ac-87b8-\
0ecf039bc4d3"],

Cell["\<\
Change how the boxes are rendered by selecting from the \
\[OpenCurlyDoubleQuote]display mode\[CloseCurlyDoubleQuote] menu.\
\>", "Text",
 CellChangeTimes->{{3.668171250761012*^9, 3.668171274627941*^9}, {
  3.668342007916317*^9, 3.668342010256302*^9}, {3.7317780334143543`*^9, 
  3.7317780447896433`*^9}},ExpressionUUID->"824a49db-09a4-4f39-9cf0-\
f65c144c7032"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Implementation", "Section",
 InitializationGroup->True,
 CellChangeTimes->{{3.6220705355133944`*^9, 3.6220705394013944`*^9}, {
  3.622635662232705*^9, 3.6226356640267625`*^9}, {3.7317781043461604`*^9, 
  3.7317781057702*^9}},ExpressionUUID->"af1b65cd-c32e-4617-95fe-7357994531af"],

Cell[BoxData[
 RowBox[{
  RowBox[{"BoxDesignWidget", "[", "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"DynamicModule", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"doc", ",", " ", "guid", ",", " ", "displayModes"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
     "LoadNETType", "[", "\"\<Rhino.Display.DisplayModeDescription\>\"", 
      "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"LoadNETType", "[", "\"\<Rhino.RhinoApp\>\"", "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"displayModes", " ", "=", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"#", "@", "EnglishName"}], ")"}], "&"}], " ", "/@", " ", 
       RowBox[{
       "Rhino`Display`DisplayModeDescription`GetDisplayModes", "[", "]"}]}]}],
      ";", "\[IndentingNewLine]", 
     RowBox[{"Manipulate", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"NETBlock", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"doc", "@", 
          RowBox[{"Objects", "@", 
           RowBox[{"Replace", "[", 
            RowBox[{"guid", ",", "\[IndentingNewLine]", 
             RowBox[{"Brep`CreateFromBox", "[", 
              RowBox[{"NETNew", "[", 
               RowBox[{
               "\"\<Rhino.Geometry.BoundingBox\>\"", ",", 
                "\[IndentingNewLine]", 
                RowBox[{"NETNew", "[", 
                 RowBox[{
                 "\"\<Rhino.Geometry.Point3d\>\"", ",", " ", "x", ",", "y", 
                  ",", "z"}], "]"}], ",", "\[IndentingNewLine]", 
                RowBox[{"NETNew", "[", 
                 RowBox[{"\"\<Rhino.Geometry.Point3d\>\"", ",", " ", 
                  RowBox[{"x", "+", "l"}], ",", 
                  RowBox[{"y", "+", "w"}], ",", 
                  RowBox[{"z", "+", "h"}]}], "]"}]}], "]"}], "]"}]}], 
            "]"}]}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"doc", "@", 
          RowBox[{"Views", "@", 
           RowBox[{"Redraw", "[", "]"}]}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"Row", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"\"\<pos:\>\"", ",", 
             RowBox[{"{", 
              RowBox[{"x", ",", "y", ",", "z"}], "}"}], ",", " ", 
             "\"\< dim:\>\"", ",", 
             RowBox[{"{", 
              RowBox[{"l", ",", "w", ",", "h"}], "}"}]}], "}"}], ",", 
           "\"\< \>\""}], "]"}]}], "\[IndentingNewLine]", "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"ActionMenu", "[", 
        RowBox[{"\"\<display mode\>\"", ",", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"#", "\[RuleDelayed]", "\[IndentingNewLine]", 
             RowBox[{"(*", " ", 
              RowBox[{
              "for", " ", "some", " ", "reason", " ", "it", " ", "takes", " ",
                "two", " ", "invocations", " ", "to", " ", "set", " ", "all", 
               " ", 
               RowBox[{"viewports", "'"}], " ", "display", " ", "modes"}], 
              " ", "*)"}], "\[IndentingNewLine]", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"RhinoApp`RunScript", "[", 
                RowBox[{
                 RowBox[{
                 "\"\<_SetDisplayMode Viewport=All \\\"\>\"", "<>", "#", 
                  "<>", "\"\<\\\" _Enter\>\""}], ",", "False"}], "]"}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"RhinoApp`RunScript", "[", 
                RowBox[{
                 RowBox[{
                 "\"\<_SetDisplayMode Viewport=All \\\"\>\"", "<>", "#", 
                  "<>", "\"\<\\\" _Enter\>\""}], ",", "False"}], "]"}]}], 
              ")"}]}], "\[IndentingNewLine]", ")"}], "&"}], " ", "/@", " ", 
          "displayModes"}], ",", 
         RowBox[{"ImageSize", "\[Rule]", "Medium"}]}], "]"}], ",", 
       "\[IndentingNewLine]", "Delimiter", ",", "\[IndentingNewLine]", 
       RowBox[{"Grid", "[", 
        RowBox[{
         RowBox[{"Transpose", "@", 
          RowBox[{"{", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
             "\"\<length\>\"", ",", "\"\<width\>\"", ",", "\"\<height\>\""}], 
             "}"}], ",", "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Control", "[", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"l", ",", "1", ",", "\"\<\>\""}], "}"}], ",", "1", 
                 ",", "10", ",", "1", ",", 
                 RowBox[{"ImageSize", "\[Rule]", "Small"}]}], "}"}], "]"}], 
              ",", "\[IndentingNewLine]", 
              RowBox[{"Control", "[", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"w", ",", "1", ",", "\"\<\>\""}], "}"}], ",", "1", 
                 ",", "10", ",", "1", ",", 
                 RowBox[{"ImageSize", "\[Rule]", "Small"}]}], "}"}], "]"}], 
              ",", "\[IndentingNewLine]", 
              RowBox[{"Control", "[", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"h", ",", "1", ",", "\"\<\>\""}], "}"}], ",", "1", 
                 ",", "10", ",", "1", ",", 
                 RowBox[{"ImageSize", "\[Rule]", "Small"}]}], "}"}], "]"}]}], 
             "}"}], ",", "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{"\"\<\>\"", ",", "\"\<\>\"", ",", "\"\<\>\""}], "}"}], 
            ",", "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{"\"\<x\>\"", ",", "\"\<y\>\"", ",", "\"\<z\>\""}], "}"}],
             ",", "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Control", "[", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"x", ",", "0", ",", "\"\<\>\""}], "}"}], ",", "0", 
                 ",", "10", ",", "1", ",", 
                 RowBox[{"ImageSize", "\[Rule]", "Small"}]}], "}"}], "]"}], 
              ",", "\[IndentingNewLine]", 
              RowBox[{"Control", "[", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"y", ",", "0", ",", "\"\<\>\""}], "}"}], ",", "0", 
                 ",", "10", ",", "1", ",", 
                 RowBox[{"ImageSize", "\[Rule]", "Small"}]}], "}"}], "]"}], 
              ",", "\[IndentingNewLine]", 
              RowBox[{"Control", "[", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"z", ",", "0", ",", "\"\<\>\""}], "}"}], ",", "0", 
                 ",", "10", ",", "1", ",", 
                 RowBox[{"ImageSize", "\[Rule]", "Small"}]}], "}"}], "]"}]}], 
             "}"}]}], "\[IndentingNewLine]", "}"}]}], ",", 
         RowBox[{"Alignment", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"Right", ",", "Left", ",", "Right", ",", "Left"}], 
           "}"}]}]}], "]"}], ",", "\[IndentingNewLine]", "\"\<\>\"", ",", 
       "\[IndentingNewLine]", 
       RowBox[{"Button", "[", 
        RowBox[{"\"\<new box\>\"", ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"guid", "=", 
           RowBox[{"doc", "@", 
            RowBox[{"Objects", "@", 
             RowBox[{"Add", "[", 
              RowBox[{"Brep`CreateFromBox", "[", 
               RowBox[{"NETNew", "[", 
                RowBox[{
                "\"\<Rhino.Geometry.BoundingBox\>\"", ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"NETNew", "[", 
                  RowBox[{
                  "\"\<Rhino.Geometry.Point3d\>\"", ",", " ", "x", ",", "y", 
                   ",", "z"}], "]"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"NETNew", "[", 
                  RowBox[{"\"\<Rhino.Geometry.Point3d\>\"", ",", "  ", 
                   RowBox[{"x", "+", "l"}], ",", 
                   RowBox[{"y", "+", "w"}], ",", 
                   RowBox[{"z", "+", "h"}]}], "]"}]}], "]"}], "]"}], 
              "]"}]}]}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"doc", "@", 
           RowBox[{"Views", "@", 
            RowBox[{"Redraw", "[", "]"}]}]}]}]}], "\[IndentingNewLine]", 
        "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"Button", "[", 
        RowBox[{"\"\<reset\>\"", ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"doc", "@", 
           RowBox[{"Objects", "@", 
            RowBox[{"Clear", "[", "]"}]}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"doc", "@", 
           RowBox[{"Views", "@", 
            RowBox[{"Redraw", "[", "]"}]}]}]}]}], "\[IndentingNewLine]", 
        "]"}], ",", "\[IndentingNewLine]", "\"\<\>\"", ",", 
       "\[IndentingNewLine]", 
       RowBox[{"Initialization", "\[RuleDelayed]", 
        RowBox[{"Block", "[", 
         RowBox[{
          RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"LoadNETType", "[", "\"\<Rhino.RhinoDoc\>\"", "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"LoadNETType", "[", "\"\<Rhino.Geometry.Brep\>\"", "]"}], 
           ";", "\[IndentingNewLine]", 
           RowBox[{
           "LoadNETType", "[", "\"\<Rhino.Display.DisplayModeDescription\>\"",
             "]"}], ";", "\[IndentingNewLine]", 
           RowBox[{"LoadNETType", "[", "\"\<Rhino.RhinoApp\>\"", "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"doc", "=", "RhinoDoc`ActiveDoc"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"guid", "=", 
            RowBox[{"doc", "@", 
             RowBox[{"Objects", "@", 
              RowBox[{"Add", "[", 
               RowBox[{"Brep`CreateFromBox", "[", 
                RowBox[{"NETNew", "[", 
                 RowBox[{
                 "\"\<Rhino.Geometry.BoundingBox\>\"", ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{"NETNew", "[", 
                   RowBox[{
                   "\"\<Rhino.Geometry.Point3d\>\"", ",", " ", "0", ",", "0", 
                    ",", "0"}], "]"}], ",", "\[IndentingNewLine]", 
                  RowBox[{"NETNew", "[", 
                   RowBox[{
                   "\"\<Rhino.Geometry.Point3d\>\"", ",", " ", "1", ",", "1", 
                    ",", "1"}], "]"}]}], "]"}], "]"}], "]"}]}]}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"doc", "@", 
            RowBox[{"Views", "@", 
             RowBox[{"Redraw", "[", "]"}]}]}]}]}], "\[IndentingNewLine]", 
         "]"}]}]}], "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.620861236005172*^9, 3.620861265894824*^9}, {
   3.620862175112627*^9, 3.6208623442637243`*^9}, {3.620862376602581*^9, 
   3.620862426600669*^9}, {3.6208625274704456`*^9, 3.620862540730469*^9}, {
   3.6208627629840593`*^9, 3.6208627845900974`*^9}, {3.620882392183524*^9, 
   3.6208823967387323`*^9}, {3.6208825294949656`*^9, 
   3.6208825433165903`*^9}, {3.6208826059663*^9, 3.6208826113951097`*^9}, {
   3.6208828681715603`*^9, 3.6208828989504147`*^9}, {3.6208829517565074`*^9, 
   3.6208829882761717`*^9}, {3.620883019195426*^9, 3.6208830361526556`*^9}, {
   3.6208831199872026`*^9, 3.620883140236038*^9}, {3.6208831937285323`*^9, 
   3.6208831958189363`*^9}, {3.6208832399514136`*^9, 3.620883302257923*^9}, {
   3.6208834816754403`*^9, 3.6208836564269476`*^9}, {3.620884767989106*^9, 
   3.6208847830275326`*^9}, 3.6209002366337276`*^9, {3.620900310874258*^9, 
   3.6209003443675165`*^9}, {3.62090042962354*^9, 3.6209006414211197`*^9}, {
   3.620900704055229*^9, 3.6209007103108406`*^9}, {3.6209008012122*^9, 
   3.6209008192458315`*^9}, {3.6209008628323083`*^9, 3.620900890397557*^9}, {
   3.6209009471660566`*^9, 3.620900947556057*^9}, {3.6226356496279435`*^9, 
   3.6226356558677006`*^9}, {3.62263601581553*^9, 3.622636291754629*^9}, {
   3.622636360114093*^9, 3.6226363675397882`*^9}, {3.62263639923607*^9, 
   3.6226365275403776`*^9}, {3.622636607035101*^9, 3.622636627158327*^9}, 
   3.6681710095393105`*^9, {3.7317782528317947`*^9, 3.7317782634461355`*^9}, 
   3.731778301642477*^9, {3.731778338450548*^9, 3.7317783417696543`*^9}, 
   3.731778492766512*^9, 3.731778555138667*^9, {3.7317793319700994`*^9, 
   3.7317793789693184`*^9}},
 CellLabel->"In[1]:=",ExpressionUUID->"b68cf3d2-6ef4-4f9c-972d-12d8977d1b61"]
}, Closed]]
}, Open  ]]
},
Evaluator->"RhinoAttach",
WindowSize->{580, 650},
WindowMargins->{{Automatic, 0}, {Automatic, 0}},
FrontEndVersion->"11.3 for Microsoft Windows (64-bit) (March 6, 2018)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 374, 6, 96, "Title",ExpressionUUID->"f934e75a-8f02-49ca-83d8-c79ba5b801fd"],
Cell[957, 30, 320, 9, 34, "Text",ExpressionUUID->"09d236c1-1394-4427-a88e-743caae89d70"],
Cell[CellGroupData[{
Cell[1302, 43, 202, 4, 67, "Section",ExpressionUUID->"b0ccd80e-5534-4d72-9a41-1412106bc697"],
Cell[1507, 49, 260, 6, 34, "Text",ExpressionUUID->"82e64266-4686-42cf-ad3b-7ad0d63d1cb6"],
Cell[1770, 57, 330, 7, 56, "Text",ExpressionUUID->"0f862c8e-d41b-4300-a88e-3b25b2e2d57f"],
Cell[2103, 66, 205, 3, 28, "Input",ExpressionUUID->"02b37985-8aff-4e0b-aa38-4919feb0b032"],
Cell[2311, 71, 246, 6, 56, "Text",ExpressionUUID->"86837ee1-19d4-417e-b473-cf198c7ef40a"],
Cell[2560, 79, 483, 9, 78, "Text",ExpressionUUID->"c3da9f8b-ac13-45ac-87b8-0ecf039bc4d3"],
Cell[3046, 90, 372, 7, 56, "Text",ExpressionUUID->"824a49db-09a4-4f39-9cf0-f65c144c7032"]
}, Open  ]],
Cell[CellGroupData[{
Cell[3455, 102, 286, 4, 67, "Section",ExpressionUUID->"af1b65cd-c32e-4617-95fe-7357994531af",
 InitializationGroup->True],
Cell[3744, 108, 12308, 260, 1321, "Input",ExpressionUUID->"b68cf3d2-6ef4-4f9c-972d-12d8977d1b61"]
}, Closed]]
}, Open  ]]
}
]
*)

