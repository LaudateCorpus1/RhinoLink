(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     15507,        393]
NotebookOptionsPosition[     13594,        353]
NotebookOutlinePosition[     13961,        369]
CellTagsIndexPosition[     13918,        366]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Rhino Mesh Inspector", "Title",
 CellChangeTimes->{{3.6223273910542145`*^9, 
  3.622327396623129*^9}},ExpressionUUID->"7c836f60-debf-4bb6-8143-\
d3053a787ed9"],

Cell["\<\
Make a palette that gives properties and analysis of the selected Rhino mesh.\
\
\>", "Text",
 CellChangeTimes->{{3.6223274167928944`*^9, 
  3.6223274321269083`*^9}},ExpressionUUID->"bda4e5f5-9263-4937-a095-\
f691665a5bcf"],

Cell[CellGroupData[{

Cell["Agenda", "Section",
 CellChangeTimes->{{3.6223301198320065`*^9, 
  3.6223301215791397`*^9}},ExpressionUUID->"9e2acead-6f22-4307-b22a-\
41fb38b95a6e"],

Cell["- Deselect event handler doesn\[CloseCurlyQuote]t seem to be firing", \
"Text",
 CellChangeTimes->{{3.6223301305175953`*^9, 
  3.6223301390660667`*^9}},ExpressionUUID->"6266418b-d5f4-41cf-93c5-\
02ca1596f16b"]
}, Closed]],

Cell[CellGroupData[{

Cell["Setup", "Section",
 CellChangeTimes->{{3.62232743657268*^9, 
  3.6223274369938583`*^9}},ExpressionUUID->"40a1c4ad-e7c6-46a9-9d4c-\
c97479d40330"],

Cell["Start Rhino and execute WolframConnect.", "Text",
 CellChangeTimes->{{3.62232858115055*^9, 3.6223285914462557`*^9}, {
  3.7317607750058303`*^9, 
  3.7317607787576647`*^9}},ExpressionUUID->"0c8697f4-64e9-4416-9f2a-\
8901901a4357"],

Cell["Open AssortedMeshes.3dm.", "Text",
 CellChangeTimes->{{3.6223288152048516`*^9, 
  3.622328822614519*^9}},ExpressionUUID->"10389d2e-1429-4c76-b39e-\
86b08080ace3"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Initialization", "Section",
 InitializationGroup->True,
 CellChangeTimes->{{3.6214419623624916`*^9, 
  3.6214419724163775`*^9}},ExpressionUUID->"9cfe13fd-40be-4480-b002-\
ff2999c70350"],

Cell[BoxData[
 RowBox[{"<<", 
  "\"\<C:\\\\Users\\\\carlson\\\\cvs\\\\RhinoLink\\\\Packages\\\\\
RhinoUtilities.m\>\""}]], "Input",
 CellChangeTimes->{
  3.6214491148558517`*^9, {3.621449180061448*^9, 3.621449190653508*^9}, {
   3.731437359190057*^9, 
   3.73143736568346*^9}},ExpressionUUID->"2c1f22b9-9223-4ad4-ae52-\
11c914704bb4"],

Cell[BoxData[
 RowBox[{
  RowBox[{"RhinoMeshObjectInformation", "[", "obj_", "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"mesh", "=", 
       RowBox[{"obj", "@", "MeshGeometry"}]}], ",", "isOriented", ",", 
      "hasBoundary", ",", " ", "vertices", ",", " ", "faces", ",", 
      "faceAreas", ",", "faceAspectRatios", ",", "faceCounts"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"vertices", " ", "=", " ", 
      RowBox[{
      "Wolfram`Rhino`WolframScriptingPlugIn`RhinoMeshVertices", "[", "mesh", 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"faces", " ", "=", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"vertices", "[", 
         RowBox[{"[", "#", "]"}], "]"}], "&"}], " ", "/@", " ", 
       RowBox[{
       "Wolfram`Rhino`WolframScriptingPlugIn`RhinoMeshFaces", "[", "mesh", 
        "]"}]}]}], ";", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"faceAreas", " ", "=", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"RegionMeasure", "[", 
           RowBox[{"Polygon", "[", "#", "]"}], "]"}], "&"}], " ", "/@", " ", 
         "faces"}]}], ";"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"faceAspectRatios", " ", "=", " ", "Null"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"faceCounts", " ", "=", " ", 
      RowBox[{"Sort", "[", 
       RowBox[{"Tally", "[", 
        RowBox[{"Length", "/@", "faces"}], "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Column", "[", 
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Row", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"obj", "@", 
            RowBox[{"ObjectType", "@", 
             RowBox[{"ToString", "[", "]"}]}]}], ",", "\"\<: \>\"", ",", 
           RowBox[{"obj", "@", 
            RowBox[{"ToString", "[", "]"}]}]}], "}"}], "]"}], ",", 
        "\[IndentingNewLine]", "\"\<\>\"", ",", "\[IndentingNewLine]", 
        RowBox[{"Grid", "[", 
         RowBox[{
          RowBox[{"{", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"Style", "[", 
               RowBox[{"#", ",", "Bold"}], "]"}], "&"}], " ", "/@", " ", 
             RowBox[{"{", 
              RowBox[{"\"\<Item\>\"", ",", "\"\<Count\>\""}], "}"}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{"\"\<meshes\>\"", ",", 
              RowBox[{"mesh", "@", "DisjointMeshCount"}]}], "}"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{"\"\<vertices\>\"", ",", " ", 
              RowBox[{"Length", "[", "vertices", "]"}]}], "}"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{"\"\<faces\>\"", ",", 
              RowBox[{"Length", "[", "faces", "]"}]}], "}"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{"\"\<polygons\>\"", ",", " ", "faceCounts"}], "}"}], ",",
             "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{"\"\<bytes\>\"", ",", 
              RowBox[{"mesh", "@", 
               RowBox[{"MemoryEstimate", "[", "]"}]}]}], "}"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{"\"\<\>\"", ",", "\"\<\>\""}], "}"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"Style", "[", 
               RowBox[{"#", ",", "Bold"}], "]"}], "&"}], " ", "/@", " ", 
             RowBox[{"{", 
              RowBox[{"\"\<Property\>\"", ",", "\"\<Value\>\""}], "}"}]}], 
            ",", "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{"\"\<closed\>\"", ",", 
              RowBox[{"mesh", "@", "IsClosed"}]}], "}"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{"\"\<deformable\>\"", ",", 
              RowBox[{"mesh", "@", "IsDeformable"}]}], "}"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{"\"\<valid\>\"", ",", 
              RowBox[{"mesh", "@", "IsValid"}]}], "}"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{"\"\<has brep form\>\"", ",", 
              RowBox[{"mesh", "@", "HasBrepForm"}]}], "}"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{"\"\<manifold\>\"", ",", 
              RowBox[{"mesh", "@", 
               RowBox[{"IsManifold", "[", 
                RowBox[{"True", ",", "isOriented", ",", "hasBoundary"}], 
                "]"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{"\"\<oriented\>\"", ",", "isOriented"}], "}"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{"\"\<has boundary\>\"", ",", "hasBoundary"}], "}"}], ",",
             "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{"\"\<orientation\>\"", ",", 
              RowBox[{"Switch", "[", 
               RowBox[{
                RowBox[{"mesh", "@", 
                 RowBox[{"SolidOrientation", "[", "]"}]}], ",", 
                RowBox[{"-", "1"}], ",", "\"\<inward normals\>\"", ",", "1", 
                ",", "\"\<outward normals\>\"", ",", "0", ",", 
                "\"\<not solid\>\""}], "]"}]}], "}"}]}], 
           "\[IndentingNewLine]", "}"}], ",", 
          RowBox[{"Alignment", "\[Rule]", "Left"}]}], "]"}]}], 
       RowBox[{"(*", 
        RowBox[{
        ",", "\[IndentingNewLine]", "\"\<\>\"", ",", "\[IndentingNewLine]", 
         RowBox[{"Style", "[", 
          RowBox[{"\"\<Face Area Distribution\>\"", ",", "Bold"}], "]"}], ",",
          "\[IndentingNewLine]", 
         RowBox[{"Histogram", "[", 
          RowBox[{"faceAreas", ",", 
           RowBox[{"BarOrigin", "\[Rule]", "Left"}]}], "]"}]}], "*)"}], 
       "\[IndentingNewLine]", "}"}], "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.621547950346896*^9, 3.6215479516659718`*^9}, {
   3.6216460975126066`*^9, 3.62164614513233*^9}, {3.6223251265755253`*^9, 
   3.6223253112440915`*^9}, {3.6223253536588955`*^9, 
   3.6223253880869923`*^9}, {3.6223254290667443`*^9, 
   3.6223254318434377`*^9}, {3.6223254899198637`*^9, 
   3.6223255380749035`*^9}, {3.622325631483512*^9, 3.622325767119432*^9}, {
   3.622325957728426*^9, 3.6223259742792835`*^9}, {3.62232605235378*^9, 
   3.622326081758547*^9}, 3.622326142580516*^9, {3.622326223119478*^9, 
   3.622326339132289*^9}, {3.6223264014518404`*^9, 3.62232655050298*^9}, {
   3.6223266150216846`*^9, 3.622326620762227*^9}, 3.622329083857535*^9, {
   3.622634177140487*^9, 
   3.6226342328268814`*^9}},ExpressionUUID->"872365f8-0e95-4a60-bb88-\
f7bc77ec4cab"],

Cell[BoxData[
 RowBox[{
  RowBox[{"$selectedObject", "=", "Null"}], ";"}]], "Input",
 CellChangeTimes->{
  3.6223299098392367`*^9},ExpressionUUID->"728eaf34-6856-42e9-bf9f-\
e42d5824d048"],

Cell[BoxData[
 RowBox[{
  RowBox[{"objectSelectHandler", "[", 
   RowBox[{"obj_", ",", " ", "eventArgs_"}], "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"PreemptProtect", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"$selectedObject", "=", 
     RowBox[{"First", "[", 
      RowBox[{"eventArgs", "@", "RhinoObjects"}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"KeepNETObject", "[", "$selectedObject", "]"}], ";"}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGAQAWIQrX/2imLf71eOR/KtVED0j0kljf1AeuWexBYQ/ak+
rQNE6+zunwaifUryl4DogtsLwfRy2cSNIDrhQPc2EC2efSZyIpAumciRAqI3
/XIuANFNSo1g2sygyW0SkFaMT/AG0XEFTn0g+tPC12D6z3+LPSB6zfTO/SD6
x9bFl0G0QMCJmyBa6k/eQxAtoxn2DETrFW9/D6LZmD98ANHd3xy/gmjTQ+u/
g+gTN+b+AdE9BWvA9DSfiwaTgfS+rRVmIPrJTi5bEC1yqRpMWx2NPL4X5M/v
60+AaE5tX859IHtcTCRAtJ3UswLuv0D9k7+CaQDJyMFV
  
  "],ExpressionUUID->"d40ab115-0d50-4624-bdec-d3b1abe22c65"],

Cell[BoxData[
 RowBox[{
  RowBox[{"objectDeselectHandler", "[", 
   RowBox[{"obj_", ",", " ", "eventArgs_"}], "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"PreemptProtect", "[", 
   RowBox[{
    RowBox[{"$selectedObject", "=", "Null"}], ";"}], "]"}]}]], "Input",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGAQBWIQrX/2imLf71eOR/KtVED0j0kljf1AeuWexBYQ/ak+
rQNE6+zunwaifUryl4DogtsLwfRy2cSNIDrhQPc2EC2efSZyIpAumciRAqI3
/XIuANFNSo1g2sygyW0SkFaMT/AG0XEFTn0g+tPC12D6z3+LPSB6zfTO/SD6
x9bFl0G0QMCJmyBa6k/eQxAtoxn2DETrFW9/D6LZmD98ANHd3xy/gmjTQ+u/
g+gTN+b+AdE9BWvA9DSfiwaTgfS+rRVmIPrJTi5bEC1yqRpMWx2NPL4X5M/v
60+AaE5tX859IHtcTCRAtJ3UswLuv0D9k7+C6fx/r0pBtEpNUyWIBgAvt8oj

  "],ExpressionUUID->"76569369-157f-41ea-85d2-1582510826f5"],

Cell[BoxData[
 RowBox[{
  RowBox[{"MakeMeshInspector", "[", "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"LoadNETType", "[", "\"\<Rhino.RhinoDoc\>\"", "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"AddEventHandler", "[", 
      RowBox[{"RhinoDoc`SelectObjects", ",", "objectSelectHandler"}], "]"}], 
     ";", 
     RowBox[{"AddEventHandler", "[", 
      RowBox[{"RhinoDoc`DeselectObjects", ",", "objectDeselectHandler"}], 
      "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"CreatePalette", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Pane", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Dynamic", "[", 
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"$selectedObject", "=!=", "Null"}], ",", 
             RowBox[{
             "RhinoMeshObjectInformation", "[", "$selectedObject", "]"}], 
             ",", "\"\<\>\""}], "]"}], ",", 
           RowBox[{"SynchronousUpdating", "\[Rule]", "False"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"ImageMargins", "\[Rule]", "20"}]}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"Evaluator", "\[Rule]", "\"\<RhinoAttach\>\""}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"WindowTitle", "\[Rule]", "\"\<Mesh Inspector\>\""}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"Magnification", "\[Rule]", "1.5"}]}], "\[IndentingNewLine]", 
      "]"}]}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.622329595016078*^9, 3.6223296391787577`*^9}, {
   3.622329801065593*^9, 3.6223298100975294`*^9}, {3.622329921663582*^9, 
   3.622329943268751*^9}, {3.6226355947652097`*^9, 3.622635598134654*^9}, 
   3.6236899320312414`*^9},ExpressionUUID->"9a760b7f-eab3-4e33-9627-\
e5e19f997458"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Inspector", "Section",
 CellChangeTimes->{{3.622157396311956*^9, 3.6221574025995846`*^9}, {
  3.62232964992702*^9, 
  3.622329651409001*^9}},ExpressionUUID->"59993758-6ba3-4357-b749-\
50b8c635e9a7"],

Cell[BoxData[
 RowBox[{
  RowBox[{"MakeMeshInspector", "[", "]"}], ";"}]], "Input",
 CellChangeTimes->{
  3.622330094940563*^9},ExpressionUUID->"6f5bc71c-8ca2-4042-8d25-\
ef4ab4540590"]
}, Open  ]]
}, Open  ]]
},
Evaluator->"RhinoAttach",
WindowSize->{932, 915},
WindowMargins->{{Automatic, 1}, {-8, Automatic}},
FrontEndVersion->"11.3 for Microsoft Windows (64-bit) (March 6, 2018)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 165, 3, 96, "Title",ExpressionUUID->"7c836f60-debf-4bb6-8143-d3053a787ed9"],
Cell[748, 27, 233, 6, 34, "Text",ExpressionUUID->"bda4e5f5-9263-4937-a095-f691665a5bcf"],
Cell[CellGroupData[{
Cell[1006, 37, 155, 3, 67, "Section",ExpressionUUID->"9e2acead-6f22-4307-b22a-41fb38b95a6e"],
Cell[1164, 42, 215, 4, 30, "Text",ExpressionUUID->"6266418b-d5f4-41cf-93c5-02ca1596f16b"]
}, Closed]],
Cell[CellGroupData[{
Cell[1416, 51, 151, 3, 53, "Section",ExpressionUUID->"40a1c4ad-e7c6-46a9-9d4c-c97479d40330"],
Cell[1570, 56, 235, 4, 34, "Text",ExpressionUUID->"0c8697f4-64e9-4416-9f2a-8901901a4357"],
Cell[1808, 62, 168, 3, 34, "Text",ExpressionUUID->"10389d2e-1429-4c76-b39e-86b08080ace3"]
}, Open  ]],
Cell[CellGroupData[{
Cell[2013, 70, 191, 4, 67, "Section",ExpressionUUID->"9cfe13fd-40be-4480-b002-ff2999c70350",
 InitializationGroup->True],
Cell[2207, 76, 334, 8, 28, "Input",ExpressionUUID->"2c1f22b9-9223-4ad4-ae52-11c914704bb4"],
Cell[2544, 86, 6831, 156, 656, "Input",ExpressionUUID->"872365f8-0e95-4a60-bb88-f7bc77ec4cab"],
Cell[9378, 244, 188, 5, 30, "Input",ExpressionUUID->"728eaf34-6856-42e9-bf9f-e42d5824d048"],
Cell[9569, 251, 938, 21, 115, "Input",ExpressionUUID->"d40ab115-0d50-4624-bdec-d3b1abe22c65"],
Cell[10510, 274, 732, 16, 52, "Input",ExpressionUUID->"76569369-157f-41ea-85d2-1582510826f5"],
Cell[11245, 292, 1892, 41, 312, "Input",ExpressionUUID->"9a760b7f-eab3-4e33-9627-e5e19f997458"]
}, Open  ]],
Cell[CellGroupData[{
Cell[13174, 338, 204, 4, 63, "Section",ExpressionUUID->"59993758-6ba3-4357-b749-50b8c635e9a7"],
Cell[13381, 344, 185, 5, 31, "Input",ExpressionUUID->"6f5bc71c-8ca2-4042-8d25-ef4ab4540590"]
}, Open  ]]
}, Open  ]]
}
]
*)

