(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     15305,        376]
NotebookOptionsPosition[     13743,        343]
NotebookOutlinePosition[     14109,        359]
CellTagsIndexPosition[     14066,        356]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Rhino Mesh Inspector", "Title",
 CellChangeTimes->{{3.6223273910542145`*^9, 
  3.622327396623129*^9}},ExpressionUUID->"7c836f60-debf-4bb6-8143-\
d3053a787ed9"],

Cell[TextData[{
 "Make an inspector in ",
 StyleBox["Mathematica",
  FontSlant->"Italic"],
 " that gives properties and analysis of the selected mesh in Rhino."
}], "Text",
 CellChangeTimes->{{3.6223274167928944`*^9, 3.6223274321269083`*^9}, {
  3.7318485769530735`*^9, 
  3.731848597383952*^9}},ExpressionUUID->"bda4e5f5-9263-4937-a095-\
f691665a5bcf"],

Cell[CellGroupData[{

Cell["Example", "Section",
 CellChangeTimes->{{3.62232743657268*^9, 3.6223274369938583`*^9}, {
  3.7318486693861504`*^9, 
  3.7318486702455406`*^9}},ExpressionUUID->"40a1c4ad-e7c6-46a9-9d4c-\
c97479d40330"],

Cell["\<\
If you haven\[CloseCurlyQuote]t already done so, execute WolframConnect in \
Rhino.\
\>", "Text",
 CellChangeTimes->{{3.731777804036372*^9, 3.7317778320842924`*^9}, 
   3.7318034190325947`*^9},ExpressionUUID->"e63ef99a-d704-43cc-a765-\
be2bf799aa2c"],

Cell["\<\
In Rhino, open AssortedMeshes.3dm (from the same directory as this notebook).\
\>", "Text",
 CellChangeTimes->{{3.6223288152048516`*^9, 3.622328822614519*^9}, {
  3.731848696397026*^9, 3.731848714397925*^9}, {3.7318488182800617`*^9, 
  3.73184882221751*^9}},ExpressionUUID->"10389d2e-1429-4c76-b39e-\
86b08080ace3"],

Cell["Evaluate this expression to open the mesh inspector:", "Text",
 CellChangeTimes->{{3.731848645073432*^9, 
  3.731848661229823*^9}},ExpressionUUID->"4c26cdbd-b6ec-40eb-8e00-\
e3a47a3baa57"],

Cell[BoxData[
 RowBox[{
  RowBox[{"MakeMeshInspector", "[", "]"}], ";"}]], "Input",
 CellChangeTimes->{3.622330094940563*^9},
 CellLabel->"In[7]:=",ExpressionUUID->"6f5bc71c-8ca2-4042-8d25-ef4ab4540590"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Implementation", "Section",
 InitializationGroup->True,
 CellChangeTimes->{{3.6214419623624916`*^9, 3.6214419724163775`*^9}, {
  3.731848536061338*^9, 
  3.7318485375299177`*^9}},ExpressionUUID->"9cfe13fd-40be-4480-b002-\
ff2999c70350"],

Cell[BoxData[
 RowBox[{
  RowBox[{"RhinoMeshObjectInformation", "[", "obj_", "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"mesh", "=", 
       RowBox[{"obj", "@", "MeshGeometry"}]}], ",", "isOriented", ",", 
      "hasBoundary", ",", " ", "vertices", ",", " ", "faces", ",", 
      "faceAreas", ",", "faceAspectRatios", ",", "faceCounts"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"vertices", " ", "=", " ", 
      RowBox[{
      "Wolfram`Rhino`WolframScriptingPlugIn`RhinoMeshVertices", "[", "mesh", 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"faces", " ", "=", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"vertices", "[", 
         RowBox[{"[", "#", "]"}], "]"}], "&"}], " ", "/@", " ", 
       RowBox[{
       "Wolfram`Rhino`WolframScriptingPlugIn`RhinoMeshFaces", "[", "mesh", 
        "]"}]}]}], ";", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"faceAreas", " ", "=", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"RegionMeasure", "[", 
           RowBox[{"Polygon", "[", "#", "]"}], "]"}], "&"}], " ", "/@", " ", 
         "faces"}]}], ";"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"faceAspectRatios", " ", "=", " ", "Null"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"faceCounts", " ", "=", " ", 
      RowBox[{"Sort", "[", 
       RowBox[{"Tally", "[", 
        RowBox[{"Length", "/@", "faces"}], "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Column", "[", 
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Row", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"obj", "@", 
            RowBox[{"ObjectType", "@", 
             RowBox[{"ToString", "[", "]"}]}]}], ",", "\"\<: \>\"", ",", 
           RowBox[{"obj", "@", 
            RowBox[{"ToString", "[", "]"}]}]}], "}"}], "]"}], ",", 
        "\[IndentingNewLine]", "\"\<\>\"", ",", "\[IndentingNewLine]", 
        RowBox[{"Grid", "[", 
         RowBox[{
          RowBox[{"{", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"Style", "[", 
               RowBox[{"#", ",", "Bold"}], "]"}], "&"}], " ", "/@", " ", 
             RowBox[{"{", 
              RowBox[{"\"\<Item\>\"", ",", "\"\<Count\>\""}], "}"}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{"\"\<meshes\>\"", ",", 
              RowBox[{"mesh", "@", "DisjointMeshCount"}]}], "}"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{"\"\<vertices\>\"", ",", " ", 
              RowBox[{"Length", "[", "vertices", "]"}]}], "}"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{"\"\<faces\>\"", ",", 
              RowBox[{"Length", "[", "faces", "]"}]}], "}"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{"\"\<polygons\>\"", ",", " ", "faceCounts"}], "}"}], ",",
             "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{"\"\<bytes\>\"", ",", 
              RowBox[{"mesh", "@", 
               RowBox[{"MemoryEstimate", "[", "]"}]}]}], "}"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{"\"\<\>\"", ",", "\"\<\>\""}], "}"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"Style", "[", 
               RowBox[{"#", ",", "Bold"}], "]"}], "&"}], " ", "/@", " ", 
             RowBox[{"{", 
              RowBox[{"\"\<Property\>\"", ",", "\"\<Value\>\""}], "}"}]}], 
            ",", "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{"\"\<closed\>\"", ",", 
              RowBox[{"mesh", "@", "IsClosed"}]}], "}"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{"\"\<deformable\>\"", ",", 
              RowBox[{"mesh", "@", "IsDeformable"}]}], "}"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{"\"\<valid\>\"", ",", 
              RowBox[{"mesh", "@", "IsValid"}]}], "}"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{"\"\<has brep form\>\"", ",", 
              RowBox[{"mesh", "@", "HasBrepForm"}]}], "}"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{"\"\<manifold\>\"", ",", 
              RowBox[{"mesh", "@", 
               RowBox[{"IsManifold", "[", 
                RowBox[{"True", ",", "isOriented", ",", "hasBoundary"}], 
                "]"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{"\"\<oriented\>\"", ",", "isOriented"}], "}"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{"\"\<has boundary\>\"", ",", "hasBoundary"}], "}"}], ",",
             "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{"\"\<orientation\>\"", ",", 
              RowBox[{"Switch", "[", 
               RowBox[{
                RowBox[{"mesh", "@", 
                 RowBox[{"SolidOrientation", "[", "]"}]}], ",", 
                RowBox[{"-", "1"}], ",", "\"\<inward normals\>\"", ",", "1", 
                ",", "\"\<outward normals\>\"", ",", "0", ",", 
                "\"\<not solid\>\""}], "]"}]}], "}"}]}], 
           "\[IndentingNewLine]", "}"}], ",", 
          RowBox[{"Alignment", "\[Rule]", "Left"}]}], "]"}]}], 
       RowBox[{"(*", 
        RowBox[{
        ",", "\[IndentingNewLine]", "\"\<\>\"", ",", "\[IndentingNewLine]", 
         RowBox[{"Style", "[", 
          RowBox[{"\"\<Face Area Distribution\>\"", ",", "Bold"}], "]"}], ",",
          "\[IndentingNewLine]", 
         RowBox[{"Histogram", "[", 
          RowBox[{"faceAreas", ",", 
           RowBox[{"BarOrigin", "\[Rule]", "Left"}]}], "]"}]}], "*)"}], 
       "\[IndentingNewLine]", "}"}], "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.621547950346896*^9, 3.6215479516659718`*^9}, {
   3.6216460975126066`*^9, 3.62164614513233*^9}, {3.6223251265755253`*^9, 
   3.6223253112440915`*^9}, {3.6223253536588955`*^9, 
   3.6223253880869923`*^9}, {3.6223254290667443`*^9, 
   3.6223254318434377`*^9}, {3.6223254899198637`*^9, 
   3.6223255380749035`*^9}, {3.622325631483512*^9, 3.622325767119432*^9}, {
   3.622325957728426*^9, 3.6223259742792835`*^9}, {3.62232605235378*^9, 
   3.622326081758547*^9}, 3.622326142580516*^9, {3.622326223119478*^9, 
   3.622326339132289*^9}, {3.6223264014518404`*^9, 3.62232655050298*^9}, {
   3.6223266150216846`*^9, 3.622326620762227*^9}, 3.622329083857535*^9, {
   3.622634177140487*^9, 3.6226342328268814`*^9}},
 CellLabel->"In[2]:=",ExpressionUUID->"872365f8-0e95-4a60-bb88-f7bc77ec4cab"],

Cell[BoxData[
 RowBox[{
  RowBox[{"$selectedObject", "=", "Null"}], ";"}]], "Input",
 CellChangeTimes->{3.6223299098392367`*^9},
 CellLabel->"In[3]:=",ExpressionUUID->"728eaf34-6856-42e9-bf9f-e42d5824d048"],

Cell[BoxData[
 RowBox[{
  RowBox[{"objectSelectHandler", "[", 
   RowBox[{"obj_", ",", " ", "eventArgs_"}], "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"PreemptProtect", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"$selectedObject", "=", 
     RowBox[{"First", "[", 
      RowBox[{"eventArgs", "@", "RhinoObjects"}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"KeepNETObject", "[", "$selectedObject", "]"}], ";"}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGAQAWIQrX/2imLf71eOR/KtVED0j0kljf1AeuWexBYQ/ak+
rQNE6+zunwaifUryl4DogtsLwfRy2cSNIDrhQPc2EC2efSZyIpAumciRAqI3
/XIuANFNSo1g2sygyW0SkFaMT/AG0XEFTn0g+tPC12D6z3+LPSB6zfTO/SD6
x9bFl0G0QMCJmyBa6k/eQxAtoxn2DETrFW9/D6LZmD98ANHd3xy/gmjTQ+u/
g+gTN+b+AdE9BWvA9DSfiwaTgfS+rRVmIPrJTi5bEC1yqRpMWx2NPL4X5M/v
60+AaE5tX859IHtcTCRAtJ3UswLuv0D9k7+CaQDJyMFV
  "],
 CellLabel->"In[4]:=",ExpressionUUID->"d40ab115-0d50-4624-bdec-d3b1abe22c65"],

Cell[BoxData[
 RowBox[{
  RowBox[{"objectDeselectHandler", "[", 
   RowBox[{"obj_", ",", " ", "eventArgs_"}], "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"PreemptProtect", "[", 
   RowBox[{
    RowBox[{"$selectedObject", "=", "Null"}], ";"}], "]"}]}]], "Input",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGAQBWIQrX/2imLf71eOR/KtVED0j0kljf1AeuWexBYQ/ak+
rQNE6+zunwaifUryl4DogtsLwfRy2cSNIDrhQPc2EC2efSZyIpAumciRAqI3
/XIuANFNSo1g2sygyW0SkFaMT/AG0XEFTn0g+tPC12D6z3+LPSB6zfTO/SD6
x9bFl0G0QMCJmyBa6k/eQxAtoxn2DETrFW9/D6LZmD98ANHd3xy/gmjTQ+u/
g+gTN+b+AdE9BWvA9DSfiwaTgfS+rRVmIPrJTi5bEC1yqRpMWx2NPL4X5M/v
60+AaE5tX859IHtcTCRAtJ3UswLuv0D9k7+C6fx/r0pBtEpNUyWIBgAvt8oj

  "],
 CellLabel->"In[5]:=",ExpressionUUID->"76569369-157f-41ea-85d2-1582510826f5"],

Cell[BoxData[
 RowBox[{
  RowBox[{"MakeMeshInspector", "[", "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"LoadNETType", "[", "\"\<Rhino.RhinoDoc\>\"", "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"AddEventHandler", "[", 
      RowBox[{"RhinoDoc`SelectObjects", ",", "objectSelectHandler"}], "]"}], 
     ";", 
     RowBox[{"AddEventHandler", "[", 
      RowBox[{"RhinoDoc`DeselectObjects", ",", "objectDeselectHandler"}], 
      "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"CreatePalette", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Style", "[", 
        RowBox[{
         RowBox[{"Pane", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Dynamic", "[", 
            RowBox[{
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"$selectedObject", "=!=", "Null"}], ",", 
               RowBox[{
               "RhinoMeshObjectInformation", "[", "$selectedObject", "]"}], 
               ",", "\"\<\>\""}], "]"}], ",", 
             RowBox[{"SynchronousUpdating", "\[Rule]", "False"}]}], "]"}], 
           ",", "\[IndentingNewLine]", 
           RowBox[{"ImageMargins", "\[Rule]", "20"}]}], "]"}], ",", " ", 
         "10"}], "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"Evaluator", "\[Rule]", "\"\<RhinoAttach\>\""}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"WindowTitle", "\[Rule]", "\"\<Mesh Inspector\>\""}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"WindowMargins", "->", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"Automatic", ",", " ", "20"}], "}"}], ",", " ", 
          RowBox[{"{", 
           RowBox[{"Automatic", ",", " ", "20"}], "}"}]}], "}"}]}]}], 
      "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.622329595016078*^9, 3.6223296391787577`*^9}, {
   3.622329801065593*^9, 3.6223298100975294`*^9}, {3.622329921663582*^9, 
   3.622329943268751*^9}, {3.6226355947652097`*^9, 3.622635598134654*^9}, 
   3.6236899320312414`*^9, {3.731850165357438*^9, 3.731850172651673*^9}, {
   3.7318503410730505`*^9, 3.7318503650795107`*^9}},
 CellLabel->"In[6]:=",ExpressionUUID->"9a760b7f-eab3-4e33-9627-e5e19f997458"]
}, Open  ]]
}, Open  ]]
},
Evaluator->"RhinoAttach",
WindowSize->{580, 650},
WindowMargins->{{Automatic, 0}, {Automatic, 0}},
FrontEndVersion->"11.3 for Microsoft Windows (64-bit) (March 6, 2018)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 165, 3, 96, "Title",ExpressionUUID->"7c836f60-debf-4bb6-8143-d3053a787ed9"],
Cell[748, 27, 353, 9, 56, "Text",ExpressionUUID->"bda4e5f5-9263-4937-a095-f691665a5bcf"],
Cell[CellGroupData[{
Cell[1126, 40, 206, 4, 67, "Section",ExpressionUUID->"40a1c4ad-e7c6-46a9-9d4c-c97479d40330"],
Cell[1335, 46, 260, 6, 34, "Text",ExpressionUUID->"e63ef99a-d704-43cc-a765-be2bf799aa2c"],
Cell[1598, 54, 325, 6, 56, "Text",ExpressionUUID->"10389d2e-1429-4c76-b39e-86b08080ace3"],
Cell[1926, 62, 194, 3, 34, "Text",ExpressionUUID->"4c26cdbd-b6ec-40eb-8e00-e3a47a3baa57"],
Cell[2123, 67, 203, 4, 28, "Input",ExpressionUUID->"6f5bc71c-8ca2-4042-8d25-ef4ab4540590"]
}, Open  ]],
Cell[CellGroupData[{
Cell[2363, 76, 242, 5, 67, "Section",ExpressionUUID->"9cfe13fd-40be-4480-b002-ff2999c70350",
 InitializationGroup->True],
Cell[2608, 83, 6848, 155, 770, "Input",ExpressionUUID->"872365f8-0e95-4a60-bb88-f7bc77ec4cab"],
Cell[9459, 240, 206, 4, 28, "Input",ExpressionUUID->"728eaf34-6856-42e9-bf9f-e42d5824d048"],
Cell[9668, 246, 958, 21, 105, "Input",ExpressionUUID->"d40ab115-0d50-4624-bdec-d3b1abe22c65"],
Cell[10629, 269, 755, 17, 48, "Input",ExpressionUUID->"76569369-157f-41ea-85d2-1582510826f5"],
Cell[11387, 288, 2328, 51, 333, "Input",ExpressionUUID->"9a760b7f-eab3-4e33-9627-e5e19f997458"]
}, Open  ]]
}, Open  ]]
}
]
*)

